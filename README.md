# AuthZ Demo ‚Äî –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ Django + DRF

–≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç backend –Ω–∞ Django —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–ª—è–º–∏ (User, Moderator, Admin), JWT —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ Docker.  
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL –≤ –∫–∞—á–µ—Å—Ç–≤–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Docker Compose.

---

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –ø–∞—Ä–æ–ª–µ–π –∏ email)  
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT —Ç–æ–∫–µ–Ω—ã  
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: User, Moderator, Admin  
- –ó–∞—â–∏—Ç–∞ API —á–µ—Ä–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã–µ permission –∫–ª–∞—Å—Å—ã  
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Django Admin  
- –§–∏–∫—Å—Ç—É—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (admin, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã, –æ–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)

---

## üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- Python 3.13  
- Django 5.x  
- Django REST Framework  
- PostgreSQL 16  
- Poetry –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏  
- Docker + Docker Compose  
- Gunicorn –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞  

---

# ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone <REPO_URL>
cd <PROJECT_FOLDER>
```
---

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env —Ñ–∞–π–ª–∞

–°–æ–∑–¥–∞–π—Ç–µ .env –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
POSTGRES_DB=authz_db
POSTGRES_USER=authz_user
POSTGRES_PASSWORD=secret
DJANGO_SECRET_KEY=your_secret_key_here
```

---

### 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
docker-compose up --build
```

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä db ‚Äî PostgreSQL
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä api ‚Äî Django + Gunicorn

  –°–∫—Ä–∏–ø—Ç entrypoint.sh –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
  1. –ñ–¥—ë—Ç PostgreSQL
  2. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
  3. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∏–∫—Å—Ç—É—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–µ—Å–ª–∏ –±–∞–∑–∞ –ø—É—Å—Ç–∞—è)
  4. –°–æ–±–∏—Ä–∞–µ—Ç static —Ñ–∞–π–ª—ã
  5. –ó–∞–ø—É—Å–∫–∞–µ—Ç Gunicorn —Å–µ—Ä–≤–µ—Ä

  ---

  ## üì¶ –§–∏–∫—Å—Ç—É—Ä—ã

  –§–∏–∫—Å—Ç—É—Ä—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ accounts/fixtures/users.json –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç:
  - 1 –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
  - 2 –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
  - 3 –û–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

  –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Å–µ—Ö: password123

  ---

  ## üîë API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

  –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å JWT —Ç–æ–∫–µ–Ω–æ–º —á–µ—Ä–µ–∑ Authorization: Bearer <JWT_TOKEN>.

  ### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

  POST /api/register/

  –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
  ```json
  {
    "full_name": "User One",
    "email": "user1@example.com",
    "password_1": "password123",
    "password_2": "password123"
  }
  ```
  
  –û—Ç–≤–µ—Ç:
  ```json
  {
  "message": "User registered successfully"
  }
  ```

  ---

  ### 2. –õ–æ–≥–∏–Ω

  POST /api/login/

  –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:

  ```json{
    "email": "user1@example.com",
    "password": "password123"
  }
  ```

  –û—Ç–≤–µ—Ç:

  ```json
  {
    "token": "<JWT_TOKEN>"
  }
  ```

  ---

 ### 3. Logout

GET /api/logout/

#### Headers:

```makefile
Authorization: Bearer <JWT_TOKEN>
```

–û—Ç–≤–µ—Ç:
```json
{
  "message": "Logout successful"
}
```
  
---

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

GET /api/users/

–î–æ—Å—Ç—É–ø: Moderator / Admin

–ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–∞:
```json
[
  {
    "id": 1,
    "username": "admin@example.com",
    "email": "admin@example.com",
    "role": "admin"
  },
  {
    "id": 2,
    "username": "moderator1@example.com",
    "email": "moderator1@example.com",
    "role": "moderator"
  }
]
```

–û—à–∏–±–∫–∏:

- 401 Unauthorized ‚Äî –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω –∏–ª–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω

- 403 Forbidden ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```psql
.
‚îú‚îÄ‚îÄ accounts/
‚îÇ   ‚îú‚îÄ‚îÄ fixtures/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.json
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py
‚îÇ   ‚îú‚îÄ‚îÄ views.py
‚îÇ   ‚îî‚îÄ‚îÄ permissions.py
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ settings.py
‚îÇ   ‚îî‚îÄ‚îÄ wsgi.py
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ entrypoint.sh
‚îú‚îÄ‚îÄ pyproject.toml
‚îî‚îÄ‚îÄ README.md
```

---

# –ï—Å–ª–∏ —É –≤–∞—Å –ø–æ—è–≤—è—Ç—Å—è –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ —á—Ç–æ-—Ç–æ –±—É–¥–µ—Ç –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ ‚Äî –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è! üòä
